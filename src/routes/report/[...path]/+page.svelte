<script lang="ts">
	import type { PageData } from './$types';
	import Report from '../../../components/Report.svelte';

	export let data: PageData;

	const { report, path } = data;
	const canonical = `https://ranked.vote/report/${path.join('/')}`;
	const imageUrl = `https://ranked.vote/share/${path.join('/')}.png`;

	// Defensive checks
	const hasInfo = report && report.info;
	const jurisdictionName = hasInfo ? report.info.jurisdictionName : '';
	const name = hasInfo ? report.info.name : '';
	const date = hasInfo ? report.info.date : '';
</script>

<svelte:head>
	<title>ranked.vote: {jurisdictionName} / {name} / {date ? date.substring(0, 4) : ''}</title>

	<meta property="og:title" content="{jurisdictionName} / {name}" />
	<meta property="og:image" content={imageUrl} />
	<meta property="og:url" content={canonical} />

	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:creator" content="@paulgb" />
	<meta name="twitter:title" content="{jurisdictionName} / {name}" />
	<meta name="twitter:image" content={imageUrl} />
	<meta name="twitter:url" content={canonical} />
</svelte:head>

<div class="wide container">
{#if report && report.info}
	<Report {report} />
{:else}
	<p>Report not found</p>
{/if}
<hr />
<div class="row"><p style="font-style: italic;">
	This report was generated by <a href="https://ranked.vote/">ranked.vote</a>
	and may be reproduced under <a href="https://creativecommons.org/licenses/by/2.0/">CC-BY</a>.
	Learn more <a href="https://ranked.vote/about">about ranked.vote</a>.
</p></div>
</div>

<a style="display:none;" href={"/card/" + path.join("/")}>card</a>

